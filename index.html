<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Call Center vs Branch Reconciliation</title>
<style>
  :root {
    --primary: #2563eb;
    --primary-dark: #1e40af;
    --secondary: #f59e0b;
    --bg-body: #f1f5f9;
    --bg-card: #ffffff;
    --text-main: #1e293b;
    --text-light: #64748b;
    --border: #e2e8f0;
    --success: #10b981;
    --success-bg: #d1fae5;
    --danger: #ef4444;
    --danger-bg: #fee2e2;
    --warning: #f59e0b;
    --warning-bg: #fef3c7;
    --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    --radius: 12px;
  }

  * { box-sizing: border-box; outline: none; }

  body {
    font-family: 'Inter', system-ui, -apple-system, sans-serif;
    margin: 0;
    padding: 0;
    background-color: var(--bg-body);
    color: var(--text-main);
    display: flex;
    flex-direction: column;
    min-height: 100vh;
  }

  header {
    background: var(--bg-card);
    padding: 1rem 2rem;
    box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    display: flex;
    align-items: center;
    justify-content: space-between;
  }

  .brand { font-size: 1.25rem; font-weight: 800; color: var(--primary); display: flex; align-items: center; gap: 10px; }
  
  main {
    padding: 2rem;
    max-width: 1600px;
    margin: 0 auto;
    width: 100%;
    display: grid;
    grid-template-columns: 350px 1fr;
    gap: 2rem;
  }

  @media (max-width: 1200px) {
    main { grid-template-columns: 1fr; }
  }

  /* KPI Cards */
  .kpi-grid {
    grid-column: 1 / -1;
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
    gap: 1.5rem;
    margin-bottom: 1.5rem;
  }

  .kpi-card {
    background: white;
    padding: 1.5rem;
    border-radius: var(--radius);
    box-shadow: var(--shadow);
    border: 1px solid var(--border);
  }
  
  .kpi-title { font-size: 0.85rem; color: var(--text-light); text-transform: uppercase; font-weight: 600; letter-spacing: 0.5px; }
  .kpi-value { font-size: 2rem; font-weight: 700; margin: 0.5rem 0; }
  .kpi-sub { font-size: 0.8rem; color: var(--text-light); }
  
  .text-danger { color: var(--danger); }
  .text-success { color: var(--success); }
  .text-primary { color: var(--primary); }

  /* Forms & Panels */
  .panel {
    background: var(--bg-card);
    padding: 1.5rem;
    border-radius: var(--radius);
    box-shadow: var(--shadow);
    margin-bottom: 2rem;
    height: fit-content;
  }

  h3 { margin-top: 0; font-size: 1.1rem; padding-bottom: 0.5rem; border-bottom: 1px solid var(--border); margin-bottom: 1rem; color: var(--text-main); }

  .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; }
  .form-group { margin-bottom: 1rem; }
  .form-group.full { grid-column: 1 / -1; }

  label { display: block; margin-bottom: 0.4rem; font-size: 0.9rem; font-weight: 600; color: var(--text-main); }
  input, select {
    width: 100%;
    padding: 0.7rem;
    border: 1px solid var(--border);
    border-radius: 8px;
    font-size: 0.95rem;
    transition: border-color 0.2s;
  }
  input:focus, select:focus { border-color: var(--primary); ring: 2px solid var(--primary); }

  button.btn-add {
    width: 100%;
    padding: 0.8rem;
    background: var(--primary);
    color: white;
    border: none;
    border-radius: 8px;
    font-weight: 600;
    cursor: pointer;
    margin-top: 1rem;
  }
  button.btn-add:hover { background: var(--primary-dark); }

  /* Table */
  .table-wrapper { overflow-x: auto; background: white; border-radius: var(--radius); box-shadow: var(--shadow); border: 1px solid var(--border); }
  table { width: 100%; border-collapse: collapse; font-size: 0.9rem; }
  th, td { padding: 1rem; text-align: left; border-bottom: 1px solid var(--border); white-space: nowrap; }
  
  thead { background: #f8fafc; }
  th { font-weight: 600; color: var(--text-light); font-size: 0.8rem; text-transform: uppercase; }
  
  tbody tr:hover { background: #f8fafc; }

  .diff-positive { background: #fee2e2; color: #b91c1c; font-weight: 700; } /* Red if discrepancy exists */
  .diff-zero { background: #d1fae5; color: #047857; font-weight: 700; } /* Green if match */

  .badge {
    padding: 4px 8px;
    border-radius: 4px;
    font-size: 0.75rem;
    font-weight: 700;
  }
  .badge-red { background: var(--danger-bg); color: var(--danger); }
  .badge-green { background: var(--success-bg); color: var(--success); }

  .action-btn {
    background: none; border: none; cursor: pointer; color: var(--text-light);
    padding: 5px; border-radius: 4px;
  }
  .action-btn:hover { color: var(--danger); background: var(--danger-bg); }
</style>
</head>
<body>

<header>
  <div class="brand">
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/></svg>
    Delivery Reconciliation
  </div>
</header>

<main>
  <!-- KPI Dashboard -->
  <div class="kpi-grid">
    <div class="kpi-card">
      <div class="kpi-title">CC Orders (Received)</div>
      <div class="kpi-value text-primary" id="kpiCcQty">0</div>
    </div>
    <div class="kpi-card">
      <div class="kpi-title">Branch Sales (Actual)</div>
      <div class="kpi-value text-success" id="kpiBranchQty">0</div>
    </div>
    <div class="kpi-card" style="border-left: 5px solid var(--danger);">
      <div class="kpi-title">Discrepancy (Qty)</div>
      <div class="kpi-value text-danger" id="kpiDiffQty">0</div>
      <div class="kpi-sub">Orders missing at Branch</div>
    </div>
    <div class="kpi-card" style="border-left: 5px solid var(--secondary);">
      <div class="kpi-title">Discrepancy ($)</div>
      <div class="kpi-value text-danger" id="kpiDiffAmt">0</div>
      <div class="kpi-sub">Financial Loss</div>
    </div>
  </div>

  <!-- Left Column: Input Form -->
  <section>
    <div class="panel">
      <h3>Add Daily Entry</h3>
      <form id="dataForm" onsubmit="event.preventDefault(); addEntry();">
        <div class="form-group">
          <label>Date</label>
          <input type="date" id="inpDate" required>
        </div>
        <div class="form-group">
          <label>Branch</label>
          <select id="inpBranch" required>
            <option>Hamdan St</option>
            <option>Al Khalidiyah</option>
            <option>Shabiya 11</option>
            <option>Muroor</option>
            <option>Al Majaz</option>
            <option>Al Barsha</option>
            <option>Al Satwa</option>
            <option>Al Rigga</option>
          </select>
        </div>

        <div style="margin: 1.5rem 0 0.5rem 0; font-size: 0.85rem; font-weight: 700; color: var(--primary); text-transform: uppercase;">Call Center Data</div>
        
        <div class="form-row">
          <div class="form-group">
            <label>CC Orders (Qty)</label>
            <input type="number" id="inpCcQty" min="0" placeholder="e.g. 10" required>
          </div>
          <div class="form-group">
            <label>CC Total Amount</label>
            <input type="number" id="inpCcAmt" min="0" step="0.01" placeholder="e.g. 200" required>
          </div>
        </div>

        <div style="margin: 1.5rem 0 0.5rem 0; font-size: 0.85rem; font-weight: 700; color: var(--success); text-transform: uppercase;">Branch Data (Actual)</div>

        <div class="form-row">
          <div class="form-group">
            <label>Branch Sales (Qty)</label>
            <input type="number" id="inpBranchQty" min="0" placeholder="e.g. 9" required>
          </div>
          <div class="form-group">
            <label>Branch Total Amount</label>
            <input type="number" id="inpBranchAmt" min="0" step="0.01" placeholder="e.g. 190" required>
          </div>
        </div>

        <button type="submit" class="btn-add">Add Record</button>
      </form>
    </div>

    <div class="panel">
      <h3>Filters</h3>
      <div class="form-group">
        <label>Branch</label>
        <select id="filterBranch" onchange="renderTable()">
          <option value="">All Branches</option>
          <option>Hamdan St</option>
          <option>Al Khalidiyah</option>
          <option>Shabiya 11</option>
          <option>Muroor</option>
          <option>Al Majaz</option>
          <option>Al Barsha</option>
          <option>Al Satwa</option>
          <option>Al Rigga</option>
        </select>
      </div>
      <div class="form-group">
        <label>Date</label>
        <input type="date" id="filterDate" onchange="renderTable()">
      </div>
    </div>
  </section>

  <!-- Right Column: Table Report -->
  <section class="table-wrapper">
    <table id="reportTable">
      <thead>
        <tr>
          <th>Date</th>
          <th>Branch</th>
          <th style="color:var(--primary)">CC Qty</th>
          <th style="color:var(--primary)">CC Amt</th>
          <th style="color:var(--success)">Branch Qty</th>
          <th style="color:var(--success)">Branch Amt</th>
          <th style="background:#fee2e2; color:#b91c1c;">Diff Qty</th>
          <th style="background:#fee2e2; color:#b91c1c;">Diff Amt</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody id="tableBody">
        <!-- Rows here -->
      </tbody>
    </table>
    <div id="emptyMsg" style="padding: 2rem; text-align: center; color: #999; display: none;">No records found.</div>
  </section>
</main>

<script>
  // State
  let data = [
    // Sample Data showing discrepancy
    { id: 1, date: '2023-10-25', branch: 'Hamdan St', ccQty: 10, ccAmt: 200.00, branchQty: 9, branchAmt: 190.00 },
    { id: 2, date: '2023-10-25', branch: 'Al Majaz', ccQty: 15, ccAmt: 300.00, branchQty: 15, branchAmt: 300.00 },
    { id: 3, date: '2023-10-24', branch: 'Muroor', ccQty: 5, ccAmt: 100.00, branchQty: 4, branchAmt: 80.00 }
  ];

  // Init
  document.getElementById('inpDate').valueAsDate = new Date();
  renderTable();

  function addEntry() {
    const date = document.getElementById('inpDate').value;
    const branch = document.getElementById('inpBranch').value;
    const ccQty = parseInt(document.getElementById('inpCcQty').value) || 0;
    const ccAmt = parseFloat(document.getElementById('inpCcAmt').value) || 0;
    const branchQty = parseInt(document.getElementById('inpBranchQty').value) || 0;
    const branchAmt = parseFloat(document.getElementById('inpBranchAmt').value) || 0;

    data.push({
      id: Date.now(),
      date, branch, ccQty, ccAmt, branchQty, branchAmt
    });

    // Reset numeric fields only
    document.getElementById('inpCcQty').value = '';
    document.getElementById('inpCcAmt').value = '';
    document.getElementById('inpBranchQty').value = '';
    document.getElementById('inpBranchAmt').value = '';

    renderTable();
    alert("Record Added Successfully!");
  }

  function deleteRow(id) {
    if(confirm("Delete this record?")) {
      data = data.filter(d => d.id !== id);
      renderTable();
    }
  }

  function renderTable() {
    const tbody = document.getElementById('tableBody');
    const fBranch = document.getElementById('filterBranch').value;
    const fDate = document.getElementById('filterDate').value;
    const emptyMsg = document.getElementById('emptyMsg');

    tbody.innerHTML = '';

    let filtered = data.filter(d => {
      return (fBranch === '' || d.branch === fBranch) &&
             (fDate === '' || d.date === fDate);
    });

    if(filtered.length === 0) {
      emptyMsg.style.display = 'block';
    } else {
      emptyMsg.style.display = 'none';
    }

    let totals = { ccQty: 0, branchQty: 0, ccAmt: 0, branchAmt: 0 };

    filtered.forEach(row => {
      const diffQty = row.ccQty - row.branchQty;
      const diffAmt = parseFloat((row.ccAmt - row.branchAmt).toFixed(2));

      totals.ccQty += row.ccQty;
      totals.branchQty += row.branchQty;
      totals.ccAmt += row.ccAmt;
      totals.branchAmt += row.branchAmt;

      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>${row.date}</td>
        <td><strong>${row.branch}</strong></td>
        <td>${row.ccQty}</td>
        <td>${row.ccAmt.toFixed(2)}</td>
        <td>${row.branchQty}</td>
        <td>${row.branchAmt.toFixed(2)}</td>
        <td class="${diffQty > 0 ? 'diff-positive' : 'diff-zero'}">${diffQty > 0 ? '-' + diffQty : diffQty}</td>
        <td class="${diffAmt > 0 ? 'diff-positive' : 'diff-zero'}">${diffAmt > 0 ? '-' + diffAmt.toFixed(2) : diffAmt.toFixed(2)}</td>
        <td>
          <button class="action-btn" onclick="deleteRow(${row.id})">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg>
          </button>
        </td>
      `;
      tbody.appendChild(tr);
    });

    updateKPIs(totals);
  }

  function updateKPIs(t) {
    document.getElementById('kpiCcQty').innerText = t.ccQty;
    document.getElementById('kpiBranchQty').innerText = t.branchQty;
    
    const diffQty = t.ccQty - t.branchQty;
    const diffAmt = t.ccAmt - t.branchAmt;

    const diffQtyElem = document.getElementById('kpiDiffQty');
    const diffAmtElem = document.getElementById('kpiDiffAmt');

    diffQtyElem.innerText = diffQty;
    diffAmtElem.innerText = diffAmt.toFixed(2);

    if(diffQty > 0) {
      diffQtyElem.classList.add('text-danger');
      diffQtyElem.classList.remove('text-success');
    } else {
      diffQtyElem.classList.add('text-success');
      diffQtyElem.classList.remove('text-danger');
    }
  }
</script>

</body>
</html>
